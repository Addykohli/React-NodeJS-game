{"ast":null,"code":"var _s = $RefreshSig$();\n// src/components/GameController.js\nimport { useEffect, useContext } from 'react';\nimport { GameContext } from '../context/GameContext';\nimport { tiles } from '../data/tiles';\nconst delay = ms => new Promise(res => setTimeout(res, ms));\nconst GameController = () => {\n  _s();\n  const {\n    players,\n    setPlayers,\n    currentPlayerIndex,\n    originalCount,\n    // fixed dice sum\n    currentCount,\n    // moves left\n    setOriginalCount,\n    setCurrentCount,\n    isMoving,\n    setIsMoving\n  } = useContext(GameContext);\n  useEffect(() => {\n    if (!isMoving || currentCount <= 0) return;\n    const movePlayer = async () => {\n      let movesLeft = currentCount;\n      const updatedPlayers = [...players];\n      const player = updatedPlayers[currentPlayerIndex];\n      while (movesLeft > 0) {\n        const tile = tiles.find(t => {\n          var _ref;\n          return (_ref = t.id === player.currentTile) !== null && _ref !== void 0 ? _ref : 1;\n        });\n        const prev = player.prevTile;\n        // filter for valid next steps\n        const candidates = (tile.next || []).filter(n => (n.from == null || n.from === prev) && (n.roll === 'any' || originalCount > 7 && n.roll === 'above' || originalCount < 7 && n.roll === 'below'));\n        let nextId;\n        if (candidates.length === 0) {\n          console.warn('No valid path from', tile.id);\n          break;\n        } else if (candidates.length === 1) {\n          nextId = candidates[0].to;\n        } else {\n          // two choices available\n          if (originalCount === 7) {\n            // ask user by tile name\n            const names = candidates.map(c => {\n              const dest = tiles.find(t => t.id === c.to);\n              return `${c.roll.toUpperCase()}: \"${dest === null || dest === void 0 ? void 0 : dest.name}\"`;\n            }).join('\\n');\n            const choice = window.prompt(`You rolled a 7! Choose your path:\\n${names}\\n\\nType \"above\" or \"below\" exactly.`);\n            const selected = candidates.find(c => c.roll === choice);\n            nextId = selected ? selected.to : candidates[0].to;\n          } else {\n            // deterministic above/below for non-7 rolls\n            nextId = candidates[0].to;\n          }\n        }\n\n        // update player\n        player.prevTile = player.currentTile;\n        player.currentTile = nextId;\n        // record move\n        setPlayers([...updatedPlayers]);\n        movesLeft--;\n        setCurrentCount(movesLeft);\n        // small animation delay\n        // eslint-disable-next-line no-await-in-loop\n        await delay(300);\n      }\n\n      // all moves done\n      setIsMoving(false);\n      setOriginalCount(0);\n      setCurrentCount(0);\n    };\n    movePlayer();\n  }, [isMoving, currentCount, players, currentPlayerIndex, originalCount, setPlayers, setIsMoving, setOriginalCount, setCurrentCount]);\n  return null;\n};\n_s(GameController, \"Vf1+/MJ62ucgLp81gh8rsZR2Hfg=\");\n_c = GameController;\nexport default GameController;\nvar _c;\n$RefreshReg$(_c, \"GameController\");","map":{"version":3,"names":["useEffect","useContext","GameContext","tiles","delay","ms","Promise","res","setTimeout","GameController","_s","players","setPlayers","currentPlayerIndex","originalCount","currentCount","setOriginalCount","setCurrentCount","isMoving","setIsMoving","movePlayer","movesLeft","updatedPlayers","player","tile","find","t","_ref","id","currentTile","prev","prevTile","candidates","next","filter","n","from","roll","nextId","length","console","warn","to","names","map","c","dest","toUpperCase","name","join","choice","window","prompt","selected","_c","$RefreshReg$"],"sources":["C:/Users/addhy/Desktop/Business_web/client/src/components/GameController.js"],"sourcesContent":["// src/components/GameController.js\r\nimport { useEffect, useContext } from 'react';\r\nimport { GameContext } from '../context/GameContext';\r\nimport { tiles } from '../data/tiles';\r\n\r\nconst delay = ms => new Promise(res => setTimeout(res, ms));\r\n\r\nconst GameController = () => {\r\n  const {\r\n    players, setPlayers,\r\n    currentPlayerIndex,\r\n    originalCount,    // fixed dice sum\r\n    currentCount,     // moves left\r\n    setOriginalCount,\r\n    setCurrentCount,\r\n    isMoving, setIsMoving\r\n  } = useContext(GameContext);\r\n\r\n  useEffect(() => {\r\n    if (!isMoving || currentCount <= 0) return;\r\n\r\n    const movePlayer = async () => {\r\n      let movesLeft = currentCount;\r\n      const updatedPlayers = [...players];\r\n      const player = updatedPlayers[currentPlayerIndex];\r\n\r\n      while (movesLeft > 0) {\r\n        const tile = tiles.find(t => t.id === player.currentTile ?? 1);\r\n        const prev = player.prevTile;\r\n        // filter for valid next steps\r\n        const candidates = (tile.next || []).filter(n =>\r\n          (n.from == null || n.from === prev) &&\r\n          (n.roll === 'any'\r\n           || (originalCount > 7 && n.roll === 'above')\r\n           || (originalCount < 7 && n.roll === 'below')\r\n          )\r\n        );\r\n\r\n        let nextId;\r\n        if (candidates.length === 0) {\r\n          console.warn('No valid path from', tile.id);\r\n          break;\r\n        } else if (candidates.length === 1) {\r\n          nextId = candidates[0].to;\r\n        } else {\r\n          // two choices available\r\n          if (originalCount === 7) {\r\n            // ask user by tile name\r\n            const names = candidates.map(c => {\r\n              const dest = tiles.find(t => t.id === c.to);\r\n              return `${c.roll.toUpperCase()}: \"${dest?.name}\"`;\r\n            }).join('\\n');\r\n            const choice = window.prompt(\r\n              `You rolled a 7! Choose your path:\\n${names}\\n\\nType \"above\" or \"below\" exactly.`\r\n            );\r\n            const selected = candidates.find(c => c.roll === choice);\r\n            nextId = selected ? selected.to : candidates[0].to;\r\n          } else {\r\n            // deterministic above/below for non-7 rolls\r\n            nextId = candidates[0].to;\r\n          }\r\n        }\r\n\r\n        // update player\r\n        player.prevTile   = player.currentTile;\r\n        player.currentTile = nextId;\r\n        // record move\r\n        setPlayers([...updatedPlayers]);\r\n\r\n        movesLeft--;\r\n        setCurrentCount(movesLeft);\r\n        // small animation delay\r\n        // eslint-disable-next-line no-await-in-loop\r\n        await delay(300);\r\n      }\r\n\r\n      // all moves done\r\n      setIsMoving(false);\r\n      setOriginalCount(0);\r\n      setCurrentCount(0);\r\n    };\r\n\r\n    movePlayer();\r\n  }, [\r\n    isMoving,\r\n    currentCount,\r\n    players,\r\n    currentPlayerIndex,\r\n    originalCount,\r\n    setPlayers,\r\n    setIsMoving,\r\n    setOriginalCount,\r\n    setCurrentCount\r\n  ]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default GameController;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}