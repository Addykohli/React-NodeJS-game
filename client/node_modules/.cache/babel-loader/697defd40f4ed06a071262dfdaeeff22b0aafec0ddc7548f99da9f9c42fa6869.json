{"ast":null,"code":"var _s = $RefreshSig$();\n// src/components/GameController.js\nimport { useContext, useEffect } from 'react';\nimport { GameContext } from '../context/GameContext';\nimport { tiles } from '../data/tiles';\nconst GameController = () => {\n  _s();\n  const {\n    players,\n    setPlayers,\n    currentPlayerIndex,\n    originalCount,\n    isMoving,\n    setOriginalCount,\n    setIsMoving\n  } = useContext(GameContext);\n  useEffect(() => {\n    if (!isMoving || originalCount <= 0) return;\n    const moveLoop = async () => {\n      let steps = originalCount;\n      const updated = [...players];\n      const me = updated[currentPlayerIndex];\n      while (steps > 0) {\n        const current = tiles.find(t => t.id === me.tileId);\n        if (!current || !Array.isArray(current.next) || current.next.length === 0) break;\n\n        // Filter out the tile we just came from\n        let opts = current.next.filter(o => o.from !== me.prevTile);\n        if (opts.length === 0) {\n          // fallback if we filtered everything out\n          opts = current.next;\n        }\n\n        // Choose the next option\n        let nextOption;\n        if (opts.length === 1) {\n          nextOption = opts[0];\n        } else if (originalCount === 7) {\n          // arbitrary choice on a 7 roll\n          nextOption = opts[0];\n        } else {\n          const rollType = originalCount < 7 ? 'below' : 'above';\n          nextOption = opts.find(o => o.roll === rollType) || opts[0];\n        }\n\n        // guard again that we actually have a valid \"to\"\n        if (!nextOption || typeof nextOption.to !== 'number') break;\n        me.prevTile = me.tileId;\n        me.tileId = nextOption.to;\n        setPlayers([...updated]);\n        steps--;\n        // pause a little between steps\n        // eslint-disable-next-line no-await-in-loop\n        await new Promise(r => setTimeout(r, 400));\n      }\n      setOriginalCount(0);\n      setIsMoving(false);\n    };\n    moveLoop();\n  }, [isMoving, originalCount, players, currentPlayerIndex, setPlayers, setOriginalCount, setIsMoving]);\n  return null;\n};\n_s(GameController, \"GJ398X102JJw69VzjndjUtUcLrI=\");\n_c = GameController;\nexport default GameController;\nvar _c;\n$RefreshReg$(_c, \"GameController\");","map":{"version":3,"names":["useContext","useEffect","GameContext","tiles","GameController","_s","players","setPlayers","currentPlayerIndex","originalCount","isMoving","setOriginalCount","setIsMoving","moveLoop","steps","updated","me","current","find","t","id","tileId","Array","isArray","next","length","opts","filter","o","from","prevTile","nextOption","rollType","roll","to","Promise","r","setTimeout","_c","$RefreshReg$"],"sources":["C:/Users/addhy/Desktop/Business_web/client/src/components/GameController.js"],"sourcesContent":["// src/components/GameController.js\r\nimport { useContext, useEffect } from 'react';\r\nimport { GameContext } from '../context/GameContext';\r\nimport { tiles } from '../data/tiles';\r\n\r\nconst GameController = () => {\r\n  const {\r\n    players,\r\n    setPlayers,\r\n    currentPlayerIndex,\r\n    originalCount,\r\n    isMoving,\r\n    setOriginalCount,\r\n    setIsMoving\r\n  } = useContext(GameContext);\r\n\r\n  useEffect(() => {\r\n    if (!isMoving || originalCount <= 0) return;\r\n\r\n    const moveLoop = async () => {\r\n      let steps = originalCount;\r\n      const updated = [...players];\r\n      const me = updated[currentPlayerIndex];\r\n\r\n      while (steps > 0) {\r\n        const current = tiles.find((t) => t.id === me.tileId);\r\n\r\n        if (!current || !Array.isArray(current.next) || current.next.length === 0) break;\r\n\r\n        // Filter out the tile we just came from\r\n        let opts = current.next.filter((o) => o.from !== me.prevTile);\r\n        if (opts.length === 0) {\r\n          // fallback if we filtered everything out\r\n          opts = current.next;\r\n        }\r\n\r\n        // Choose the next option\r\n        let nextOption;\r\n        if (opts.length === 1) {\r\n          nextOption = opts[0];\r\n        } else if (originalCount === 7) {\r\n          // arbitrary choice on a 7 roll\r\n          nextOption = opts[0];\r\n        } else {\r\n          const rollType = originalCount < 7 ? 'below' : 'above';\r\n          nextOption = opts.find((o) => o.roll === rollType) || opts[0];\r\n        }\r\n\r\n        // guard again that we actually have a valid \"to\"\r\n        if (!nextOption || typeof nextOption.to !== 'number') break;\r\n\r\n        me.prevTile = me.tileId;\r\n        me.tileId = nextOption.to;\r\n\r\n        setPlayers([...updated]);\r\n        steps--;\r\n        // pause a little between steps\r\n        // eslint-disable-next-line no-await-in-loop\r\n        await new Promise((r) => setTimeout(r, 400));\r\n      }\r\n\r\n      setOriginalCount(0);\r\n      setIsMoving(false);\r\n    };\r\n\r\n    moveLoop();\r\n  }, [\r\n    isMoving,\r\n    originalCount,\r\n    players,\r\n    currentPlayerIndex,\r\n    setPlayers,\r\n    setOriginalCount,\r\n    setIsMoving\r\n  ]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default GameController;"],"mappings":";AAAA;AACA,SAASA,UAAU,EAAEC,SAAS,QAAQ,OAAO;AAC7C,SAASC,WAAW,QAAQ,wBAAwB;AACpD,SAASC,KAAK,QAAQ,eAAe;AAErC,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAM;IACJC,OAAO;IACPC,UAAU;IACVC,kBAAkB;IAClBC,aAAa;IACbC,QAAQ;IACRC,gBAAgB;IAChBC;EACF,CAAC,GAAGZ,UAAU,CAACE,WAAW,CAAC;EAE3BD,SAAS,CAAC,MAAM;IACd,IAAI,CAACS,QAAQ,IAAID,aAAa,IAAI,CAAC,EAAE;IAErC,MAAMI,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3B,IAAIC,KAAK,GAAGL,aAAa;MACzB,MAAMM,OAAO,GAAG,CAAC,GAAGT,OAAO,CAAC;MAC5B,MAAMU,EAAE,GAAGD,OAAO,CAACP,kBAAkB,CAAC;MAEtC,OAAOM,KAAK,GAAG,CAAC,EAAE;QAChB,MAAMG,OAAO,GAAGd,KAAK,CAACe,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACC,EAAE,KAAKJ,EAAE,CAACK,MAAM,CAAC;QAErD,IAAI,CAACJ,OAAO,IAAI,CAACK,KAAK,CAACC,OAAO,CAACN,OAAO,CAACO,IAAI,CAAC,IAAIP,OAAO,CAACO,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;;QAE3E;QACA,IAAIC,IAAI,GAAGT,OAAO,CAACO,IAAI,CAACG,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACC,IAAI,KAAKb,EAAE,CAACc,QAAQ,CAAC;QAC7D,IAAIJ,IAAI,CAACD,MAAM,KAAK,CAAC,EAAE;UACrB;UACAC,IAAI,GAAGT,OAAO,CAACO,IAAI;QACrB;;QAEA;QACA,IAAIO,UAAU;QACd,IAAIL,IAAI,CAACD,MAAM,KAAK,CAAC,EAAE;UACrBM,UAAU,GAAGL,IAAI,CAAC,CAAC,CAAC;QACtB,CAAC,MAAM,IAAIjB,aAAa,KAAK,CAAC,EAAE;UAC9B;UACAsB,UAAU,GAAGL,IAAI,CAAC,CAAC,CAAC;QACtB,CAAC,MAAM;UACL,MAAMM,QAAQ,GAAGvB,aAAa,GAAG,CAAC,GAAG,OAAO,GAAG,OAAO;UACtDsB,UAAU,GAAGL,IAAI,CAACR,IAAI,CAAEU,CAAC,IAAKA,CAAC,CAACK,IAAI,KAAKD,QAAQ,CAAC,IAAIN,IAAI,CAAC,CAAC,CAAC;QAC/D;;QAEA;QACA,IAAI,CAACK,UAAU,IAAI,OAAOA,UAAU,CAACG,EAAE,KAAK,QAAQ,EAAE;QAEtDlB,EAAE,CAACc,QAAQ,GAAGd,EAAE,CAACK,MAAM;QACvBL,EAAE,CAACK,MAAM,GAAGU,UAAU,CAACG,EAAE;QAEzB3B,UAAU,CAAC,CAAC,GAAGQ,OAAO,CAAC,CAAC;QACxBD,KAAK,EAAE;QACP;QACA;QACA,MAAM,IAAIqB,OAAO,CAAEC,CAAC,IAAKC,UAAU,CAACD,CAAC,EAAE,GAAG,CAAC,CAAC;MAC9C;MAEAzB,gBAAgB,CAAC,CAAC,CAAC;MACnBC,WAAW,CAAC,KAAK,CAAC;IACpB,CAAC;IAEDC,QAAQ,CAAC,CAAC;EACZ,CAAC,EAAE,CACDH,QAAQ,EACRD,aAAa,EACbH,OAAO,EACPE,kBAAkB,EAClBD,UAAU,EACVI,gBAAgB,EAChBC,WAAW,CACZ,CAAC;EAEF,OAAO,IAAI;AACb,CAAC;AAACP,EAAA,CAxEID,cAAc;AAAAkC,EAAA,GAAdlC,cAAc;AA0EpB,eAAeA,cAAc;AAAC,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}