{"ast":null,"code":"var _s = $RefreshSig$();\n// src/components/GameController.js\nimport { useEffect, useContext } from 'react';\nimport { GameContext } from '../context/GameContext';\nimport { tiles } from '../data/tiles';\nconst GameController = () => {\n  _s();\n  const {\n    players,\n    setPlayers,\n    currentPlayerIndex,\n    originalCount,\n    setOriginalCount,\n    isMoving,\n    setIsMoving,\n    setDiceRoll\n  } = useContext(GameContext);\n  useEffect(() => {\n    if (!isMoving || originalCount <= 0) {\n      console.log('[GameController] Skipping move:', {\n        isMoving,\n        originalCount\n      });\n      return;\n    }\n    const initialTotal = originalCount;\n    let remaining = originalCount;\n    console.group(`[GameController] Begin move for ${players[currentPlayerIndex].name}`);\n    console.log('  initialTotal:', initialTotal);\n    const moveStep = async () => {\n      const updated = [...players];\n      const me = updated[currentPlayerIndex];\n      while (remaining > 0) {\n        console.log(`\\n[GameController] --- Step ${initialTotal - remaining + 1} of ${initialTotal} ---`);\n        console.log('  Current tileId:', me.tileId || 1);\n        console.log('  Prev tile:', me.prevTile);\n        const tileId = me.tileId || 1;\n        const tile = tiles.find(t => t.id === tileId);\n        console.log('  Tile data:', tile);\n        const allNext = tile.next || [];\n        console.log('  All next candidates:', allNext);\n\n        // Only those with matching from\n        const fromMatches = allNext.filter(n => n.from === me.prevTile);\n        console.log('  After from===prev filter:', fromMatches);\n        let choice = null;\n        if (initialTotal === 7) {\n          console.log('  Total == 7 logic');\n          choice = fromMatches.find(n => n.roll === 'any');\n          console.log('    any first?', choice);\n          if (!choice && fromMatches.length > 1) {\n            console.log('    prompting between:', fromMatches);\n            const goFirst = window.confirm(`[GameController] 7: choose path for step ${initialTotal - remaining + 1}\\n${fromMatches.map(n => n.to).join(' or ')}`);\n            choice = goFirst ? fromMatches[0] : fromMatches[1];\n          }\n        } else if (initialTotal < 7) {\n          console.log('  Total < 7 logic');\n          choice = fromMatches.find(n => n.roll === 'below' || n.roll === 'any');\n        } else {\n          console.log('  Total > 7 logic');\n          choice = fromMatches.find(n => n.roll === 'above' || n.roll === 'any');\n        }\n        console.log('  Chosen candidate:', choice);\n        if (!choice) {\n          console.warn(`[GameController] No valid path from tile ${tileId} with total=${initialTotal}`);\n          break;\n        }\n        me.prevTile = tileId;\n        me.tileId = choice.to;\n        remaining--;\n        console.log(`  → Moved to tile ${me.tileId}, ${remaining} steps left`);\n        setPlayers([...updated]);\n        await new Promise(res => setTimeout(res, 500));\n      }\n      console.log(`[GameController] Move complete for ${players[currentPlayerIndex].name}`);\n      console.groupEnd();\n      setIsMoving(false);\n      setOriginalCount(0);\n      setDiceRoll(null);\n    };\n    moveStep();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isMoving]);\n  return null;\n};\n_s(GameController, \"vzFcrhoNgYbTpT8227HOHyUI6WU=\");\n_c = GameController;\nexport default GameController;\nvar _c;\n$RefreshReg$(_c, \"GameController\");","map":{"version":3,"names":["useEffect","useContext","GameContext","tiles","GameController","_s","players","setPlayers","currentPlayerIndex","originalCount","setOriginalCount","isMoving","setIsMoving","setDiceRoll","console","log","initialTotal","remaining","group","name","moveStep","updated","me","tileId","prevTile","tile","find","t","id","allNext","next","fromMatches","filter","n","from","choice","roll","length","goFirst","window","confirm","map","to","join","warn","Promise","res","setTimeout","groupEnd","_c","$RefreshReg$"],"sources":["C:/Users/addhy/Desktop/Business_web/client/src/components/GameController.js"],"sourcesContent":["// src/components/GameController.js\r\nimport { useEffect, useContext } from 'react';\r\nimport { GameContext } from '../context/GameContext';\r\nimport { tiles } from '../data/tiles';\r\n\r\nconst GameController = () => {\r\n  const {\r\n    players, setPlayers,\r\n    currentPlayerIndex,\r\n    originalCount, setOriginalCount,\r\n    isMoving, setIsMoving,\r\n    setDiceRoll\r\n  } = useContext(GameContext);\r\n\r\n  useEffect(() => {\r\n    if (!isMoving || originalCount <= 0) {\r\n      console.log('[GameController] Skipping move:', { isMoving, originalCount });\r\n      return;\r\n    }\r\n\r\n    const initialTotal = originalCount;\r\n    let remaining = originalCount;\r\n\r\n    console.group(`[GameController] Begin move for ${players[currentPlayerIndex].name}`);\r\n    console.log('  initialTotal:', initialTotal);\r\n\r\n    const moveStep = async () => {\r\n      const updated = [...players];\r\n      const me = updated[currentPlayerIndex];\r\n\r\n      while (remaining > 0) {\r\n        console.log(`\\n[GameController] --- Step ${initialTotal - remaining + 1} of ${initialTotal} ---`);\r\n        console.log('  Current tileId:', me.tileId || 1);\r\n        console.log('  Prev tile:', me.prevTile);\r\n\r\n        const tileId = me.tileId || 1;\r\n        const tile = tiles.find(t => t.id === tileId);\r\n        console.log('  Tile data:', tile);\r\n\r\n        const allNext = tile.next || [];\r\n        console.log('  All next candidates:', allNext);\r\n\r\n        // Only those with matching from\r\n        const fromMatches = allNext.filter(n => n.from === me.prevTile);\r\n        console.log('  After from===prev filter:', fromMatches);\r\n\r\n        let choice = null;\r\n        if (initialTotal === 7) {\r\n          console.log('  Total == 7 logic');\r\n          choice = fromMatches.find(n => n.roll === 'any');\r\n          console.log('    any first?', choice);\r\n          if (!choice && fromMatches.length > 1) {\r\n            console.log('    prompting between:', fromMatches);\r\n            const goFirst = window.confirm(\r\n              `[GameController] 7: choose path for step ${\r\n                initialTotal - remaining + 1\r\n              }\\n${fromMatches.map(n => n.to).join(' or ')}`\r\n            );\r\n            choice = goFirst ? fromMatches[0] : fromMatches[1];\r\n          }\r\n        } else if (initialTotal < 7) {\r\n          console.log('  Total < 7 logic');\r\n          choice = fromMatches.find(n => n.roll === 'below' || n.roll === 'any');\r\n        } else {\r\n          console.log('  Total > 7 logic');\r\n          choice = fromMatches.find(n => n.roll === 'above' || n.roll === 'any');\r\n        }\r\n\r\n        console.log('  Chosen candidate:', choice);\r\n\r\n        if (!choice) {\r\n          console.warn(\r\n            `[GameController] No valid path from tile ${tileId} with total=${initialTotal}`\r\n          );\r\n          break;\r\n        }\r\n\r\n        me.prevTile = tileId;\r\n        me.tileId = choice.to;\r\n        remaining--;\r\n        console.log(`  → Moved to tile ${me.tileId}, ${remaining} steps left`);\r\n        setPlayers([...updated]);\r\n\r\n        await new Promise(res => setTimeout(res, 500));\r\n      }\r\n\r\n      console.log(`[GameController] Move complete for ${players[currentPlayerIndex].name}`);\r\n      console.groupEnd();\r\n      setIsMoving(false);\r\n      setOriginalCount(0);\r\n      setDiceRoll(null);\r\n    };\r\n\r\n    moveStep();\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isMoving]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default GameController;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}