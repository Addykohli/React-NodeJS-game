{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useContext, useEffect } from 'react';\nimport { GameContext } from '../context/GameContext';\nimport { tiles } from '../data/tiles';\nconst delay = ms => new Promise(res => setTimeout(res, ms));\nconst GameController = () => {\n  _s();\n  const {\n    socket,\n    players,\n    setPlayers,\n    currentPlayerIndex,\n    originalCount,\n    isMoving,\n    setIsMoving\n  } = useContext(GameContext);\n  useEffect(() => {\n    if (!isMoving || originalCount <= 0) return;\n    (async () => {\n      let count = originalCount;\n      const updated = [...players];\n      const pl = updated[currentPlayerIndex];\n      while (count > 0) {\n        var _opts$;\n        await delay(500);\n        const cur = tiles.find(t => t.id === pl.tileId) || tiles[0];\n        // filter backtrack\n        const opts = cur.next.filter(o => o.from !== pl.prevTile);\n        const next = (_opts$ = opts[0]) === null || _opts$ === void 0 ? void 0 : _opts$.to;\n        pl.prevTile = pl.tileId;\n        pl.tileId = next;\n        setPlayers([...updated]);\n        socket.emit('boardUpdate', updated);\n        count--;\n      }\n      setIsMoving(false);\n    })();\n  }, [isMoving, originalCount, currentPlayerIndex, players, setPlayers, setIsMoving, socket]);\n  return null;\n};\n_s(GameController, \"icWohXMy144kJ5D2dQK1OxBlElE=\");\n_c = GameController;\nexport default GameController;\nvar _c;\n$RefreshReg$(_c, \"GameController\");","map":{"version":3,"names":["useContext","useEffect","GameContext","tiles","delay","ms","Promise","res","setTimeout","GameController","_s","socket","players","setPlayers","currentPlayerIndex","originalCount","isMoving","setIsMoving","count","updated","pl","_opts$","cur","find","t","id","tileId","opts","next","filter","o","from","prevTile","to","emit","_c","$RefreshReg$"],"sources":["C:/Users/addhy/Desktop/Business_web/client/src/components/GameController.js"],"sourcesContent":["import { useContext, useEffect } from 'react';\r\nimport { GameContext } from '../context/GameContext';\r\nimport { tiles } from '../data/tiles';\r\n\r\nconst delay = ms => new Promise(res => setTimeout(res, ms));\r\n\r\nconst GameController = () => {\r\n  const {\r\n    socket,\r\n    players,\r\n    setPlayers,\r\n    currentPlayerIndex,\r\n    originalCount,\r\n    isMoving,\r\n    setIsMoving\r\n  } = useContext(GameContext);\r\n\r\n  useEffect(() => {\r\n    if (!isMoving || originalCount <= 0) return;\r\n\r\n    (async () => {\r\n      let count = originalCount;\r\n      const updated = [...players];\r\n      const pl = updated[currentPlayerIndex];\r\n\r\n      while (count > 0) {\r\n        await delay(500);\r\n        const cur = tiles.find(t => t.id === pl.tileId) || tiles[0];\r\n        // filter backtrack\r\n        const opts = cur.next.filter(o => o.from !== pl.prevTile);\r\n        const next = opts[0]?.to;\r\n        pl.prevTile = pl.tileId;\r\n        pl.tileId = next;\r\n        setPlayers([...updated]);\r\n        socket.emit('boardUpdate', updated);\r\n        count--;\r\n      }\r\n\r\n      setIsMoving(false);\r\n    })();\r\n  }, [\r\n    isMoving,\r\n    originalCount,\r\n    currentPlayerIndex,\r\n    players,\r\n    setPlayers,\r\n    setIsMoving,\r\n    socket\r\n  ]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default GameController;\r\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,QAAQ,OAAO;AAC7C,SAASC,WAAW,QAAQ,wBAAwB;AACpD,SAASC,KAAK,QAAQ,eAAe;AAErC,MAAMC,KAAK,GAAGC,EAAE,IAAI,IAAIC,OAAO,CAACC,GAAG,IAAIC,UAAU,CAACD,GAAG,EAAEF,EAAE,CAAC,CAAC;AAE3D,MAAMI,cAAc,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAM;IACJC,MAAM;IACNC,OAAO;IACPC,UAAU;IACVC,kBAAkB;IAClBC,aAAa;IACbC,QAAQ;IACRC;EACF,CAAC,GAAGjB,UAAU,CAACE,WAAW,CAAC;EAE3BD,SAAS,CAAC,MAAM;IACd,IAAI,CAACe,QAAQ,IAAID,aAAa,IAAI,CAAC,EAAE;IAErC,CAAC,YAAY;MACX,IAAIG,KAAK,GAAGH,aAAa;MACzB,MAAMI,OAAO,GAAG,CAAC,GAAGP,OAAO,CAAC;MAC5B,MAAMQ,EAAE,GAAGD,OAAO,CAACL,kBAAkB,CAAC;MAEtC,OAAOI,KAAK,GAAG,CAAC,EAAE;QAAA,IAAAG,MAAA;QAChB,MAAMjB,KAAK,CAAC,GAAG,CAAC;QAChB,MAAMkB,GAAG,GAAGnB,KAAK,CAACoB,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKL,EAAE,CAACM,MAAM,CAAC,IAAIvB,KAAK,CAAC,CAAC,CAAC;QAC3D;QACA,MAAMwB,IAAI,GAAGL,GAAG,CAACM,IAAI,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKX,EAAE,CAACY,QAAQ,CAAC;QACzD,MAAMJ,IAAI,IAAAP,MAAA,GAAGM,IAAI,CAAC,CAAC,CAAC,cAAAN,MAAA,uBAAPA,MAAA,CAASY,EAAE;QACxBb,EAAE,CAACY,QAAQ,GAAGZ,EAAE,CAACM,MAAM;QACvBN,EAAE,CAACM,MAAM,GAAGE,IAAI;QAChBf,UAAU,CAAC,CAAC,GAAGM,OAAO,CAAC,CAAC;QACxBR,MAAM,CAACuB,IAAI,CAAC,aAAa,EAAEf,OAAO,CAAC;QACnCD,KAAK,EAAE;MACT;MAEAD,WAAW,CAAC,KAAK,CAAC;IACpB,CAAC,EAAE,CAAC;EACN,CAAC,EAAE,CACDD,QAAQ,EACRD,aAAa,EACbD,kBAAkB,EAClBF,OAAO,EACPC,UAAU,EACVI,WAAW,EACXN,MAAM,CACP,CAAC;EAEF,OAAO,IAAI;AACb,CAAC;AAACD,EAAA,CA7CID,cAAc;AAAA0B,EAAA,GAAd1B,cAAc;AA+CpB,eAAeA,cAAc;AAAC,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}